# תיקון בעיות הרשאות ב-Google Apps Script

אם אתה מקבל שגיאות הרשאות, עקוב אחר השלבים הבאים:

## שלב 1: אשר את ההרשאות

1. **פתח את Google Apps Script**
   - לך ל-[script.google.com](https://script.google.com)
   - פתח את הפרויקט שלך

2. **הפעל את הפונקציה doPost**
   - לחץ על **הפעל** (Run) → בחר `doPost`
   - יופיע חלון הרשאות

3. **אשר את ההרשאות**
   - לחץ על **סקור הרשאות** (Review Permissions)
   - בחר את החשבון Google שלך
   - יופיע אזהרה "Google לא אימת את האפליקציה הזו"
   - לחץ על **מתקדם** (Advanced)
   - לחץ על **עבור אל [שם הפרויקט] (לא מאובטח)** (Go to [project name] (unsafe))
   - לחץ על **אפשר** (Allow)

4. **אשר את כל ההרשאות הנדרשות:**
   - ✅ גישה ל-Google Sheets
   - ✅ קריאה וכתיבה לגיליונות

## שלב 2: פרסם מחדש כאפליקציית אינטרנט

1. **פתח את תפריט הפרסום**
   - לחץ על **פרסום** (Deploy) → **פרוס כאפליקציית אינטרנט** (Deploy as web app)

2. **הגדר את ההרשאות:**
   - **הרצה כ**: בחר **אני** (Me - [האימייל שלך])
   - **מי יכול לגשת**: בחר **כל אחד** (Anyone)
   - **תצורת אבטחה**: בחר **כל אחד יכול לגשת לאפליקציה** (Execute as me)

3. **פרסם**
   - לחץ על **פרוס** (Deploy)
   - העתק את ה-URL החדש (אם השתנה)

## שלב 3: בדוק שהכל עובד

1. **בדוק את doGet:**
   - פתח בדפדפן: `https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec?action=get`
   - אתה אמור לראות JSON עם מתכונים (או רשימה ריקה)

2. **בדוק את doPost:**
   - פתח את `admin.html`
   - נסה לשמור מתכון חדש
   - בדוק את הקונסול (F12) אם יש שגיאות

## בעיות נפוצות ופתרונות:

### בעיה: "הגישה נדחתה"
**פתרון:**
- ודא שפרסמת כאפליקציית אינטרנט עם "כל אחד יכול לגשת"
- ודא שהרצת את doPost ואישרת את ההרשאות

### בעיה: "האפליקציה לא מאומתת"
**פתרון:**
- זה נורמלי! לחץ על "מתקדם" ואז "עבור אל [שם הפרויקט]"
- זה קורה כי זה Apps Script פרטי שלך

### בעיה: "שגיאת הרשאות בגיליון"
**פתרון:**
- ודא שהגיליון "מתכונים" קיים
- ודא שיש לך הרשאות עריכה בגיליון
- נסה לשתף את הגיליון עם עצמך (אם צריך)

### בעיה: "הקוד לא מתעדכן"
**פתרון:**
- אחרי כל שינוי בקוד, צריך לפרסם מחדש
- לחץ על **פרסום** → **נהל פריסות** (Manage deployments)
- לחץ על העיפרון (עריכה) → **פרוס גרסה חדשה**

## טיפים:

1. **שמור את ה-URL של ה-Apps Script** - תצטרך אותו ב-`app.js`
2. **אחרי כל שינוי בקוד** - פרסם מחדש
3. **בדוק את הקונסול** - אם יש שגיאות, הן יופיעו שם

## אם כלום לא עובד:

1. צור Apps Script חדש מההתחלה
2. העתק את הקוד מ-`GOOGLE_SHEETS_SETUP.md`
3. פרסם מחדש
4. עדכן את ה-URL ב-`app.js`

